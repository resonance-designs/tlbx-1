import {
    Button,
    ComboBox
} from "std-widgets.slint";

import {
    RDSSlider,
    RDSVertVUMeter,
    RDSKnob,
    RDSWaveformViz
} from "./components/index.slint";

export component TapeEngine {
    in property <bool> is-recording: false;

    in-out property <float> track-level: 1.0;
    in property <float> track-meter-left: 0.0;
    in property <float> track-meter-right: 0.0;

    in property <[float]> waveform;
    in property <[string]> waveform_time_labels;
    in property <int> playhead-index: 0;

    in-out property <float> tape-speed: 1.0;
    in-out property <float> tape-rotate: 0.0;
    in-out property <float> trigger-start: 0.0;
    in-out property <float> loop-start: 0.0;
    in-out property <float> loop-length: 1.0;
    in-out property <float> tape-glide: 0.0;
    in-out property <float> tape-sos: 0.0;
    in-out property <float> loop-xfade: 0.0;

    in property <[string]> tape-rate-modes;
    in-out property <int> tape-rate-mode: 0;
    in property <[string]> loop-modes;
    in-out property <int> loop-mode: 0;

    in-out property <bool> track-muted: false;
    in-out property <bool> loop-enabled: true;
    in-out property <bool> tape-reverse: false;
    in-out property <bool> tape-freeze: false;
    in-out property <bool> tape-keylock: false;
    in-out property <bool> tape-monitor: false;
    in-out property <bool> tape-overdub: false;

    in-out property <bool> mosaic-enabled: true;
    in-out property <float> mosaic-pitch: 0.0;
    in-out property <float> mosaic-rate: 0.5;
    in-out property <float> mosaic-size: 0.5;
    in-out property <float> mosaic-contour: 0.5;
    in-out property <float> mosaic-warp: 0.0;
    in-out property <float> mosaic-spray: 0.0;
    in-out property <float> mosaic-pattern: 0.0;
    in-out property <float> mosaic-wet: 0.0;
    in-out property <float> mosaic-detune: 0.0;
    in-out property <float> mosaic-spatial: 0.0;
    in-out property <float> mosaic-rand-rate: 0.0;
    in-out property <float> mosaic-rand-size: 0.0;
    in-out property <float> mosaic-sos: 0.0;

    in-out property <bool> ring-enabled: false;
    in-out property <float> ring-cutoff: 0.5;
    in-out property <float> ring-resonance: 0.0;
    in-out property <float> ring-decay: 0.0;
    in-out property <float> ring-pitch: 0.5;
    in property <[string]> ring-decay-modes;
    in-out property <int> ring-decay-mode: 0;
    in-out property <float> ring-slope: 0.5;
    in-out property <float> ring-tone: 0.5;
    in-out property <float> ring-tilt: 0.5;
    in-out property <float> ring-wet: 0.0;
    in-out property <float> ring-detune: 0.0;
    in-out property <float> ring-waves: 0.0;
    in-out property <float> ring-waves-rate: 0.5;
    in-out property <float> ring-noise: 0.0;
    in-out property <float> ring-noise-rate: 0.5;

    callback load-sample();
    callback save-sample();
    callback toggle-record();
    callback audition-start();
    callback audition-end();

    callback track-level-changed(value: float);
    callback tape-speed-changed(value: float);
    callback tape-rotate-changed(value: float);
    callback trigger-start-changed(value: float);
    callback loop-start-changed(value: float);
    callback loop-length-changed(value: float);
    callback tape-glide-changed(value: float);
    callback tape-sos-changed(value: float);
    callback loop-xfade-changed(value: float);
    callback tape-rate-mode-selected(index: int);
    callback loop-mode-selected(index: int);

    callback toggle-track-mute();
    callback toggle-loop-enabled();
    callback toggle-tape-reverse();
    callback toggle-tape-freeze();
    callback toggle-tape-keylock();
    callback toggle-tape-monitor();
    callback toggle-tape-overdub();

    callback toggle-mosaic-enabled();
    callback mosaic-pitch-changed(value: float);
    callback mosaic-rate-changed(value: float);
    callback mosaic-size-changed(value: float);
    callback mosaic-contour-changed(value: float);
    callback mosaic-warp-changed(value: float);
    callback mosaic-spray-changed(value: float);
    callback mosaic-pattern-changed(value: float);
    callback mosaic-wet-changed(value: float);
    callback mosaic-detune-changed(value: float);
    callback mosaic-spatial-changed(value: float);
    callback mosaic-rand-rate-changed(value: float);
    callback mosaic-rand-size-changed(value: float);
    callback mosaic-sos-changed(value: float);

    callback toggle-ring-enabled();
    callback ring-cutoff-changed(value: float);
    callback ring-resonance-changed(value: float);
    callback ring-decay-changed(value: float);
    callback ring-pitch-changed(value: float);
    callback ring-decay-mode-selected(index: int);
    callback ring-slope-changed(value: float);
    callback ring-tone-changed(value: float);
    callback ring-tilt-changed(value: float);
    callback ring-wet-changed(value: float);
    callback ring-detune-changed(value: float);
    callback ring-waves-changed(value: float);
    callback ring-waves-rate-changed(value: float);
    callback ring-noise-changed(value: float);
    callback ring-noise-rate-changed(value: float);

    VerticalLayout {
        spacing: 8px;
        width: parent.width;

        HorizontalLayout {
            spacing: 8px;
            width: parent.width;
            Button { text: "Load Sample"; clicked => root.load-sample(); }
            Button { text: "Save Sample"; clicked => root.save-sample(); }
            Button { text: root.is-recording ? "Stop Record" : "Record"; clicked => root.toggle-record(); }
            Rectangle {
                width: 80px;
                height: 28px;
                background: ta.pressed ? #4a0d7a : #2a2a35;
                border-radius: 4px;
                border-color: #3f3f4a;
                border-width: 1px;
                Text {
                    text: "Audition";
                    color: #f0f0f2;
                    font-size: 11px;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
                ta := TouchArea {
                    pointer-event(event) => {
                        if (event.kind == PointerEventKind.down) {
                            root.audition-start();
                        } else if (event.kind == PointerEventKind.up || event.kind == PointerEventKind.cancel) {
                            root.audition-end();
                        }
                    }
                }
            }
        }

        HorizontalLayout {
            width: parent.width;
            spacing: 12px;
            height: 200px;

            RDSSlider {
                value: root.track-level;
                min-value: 0;
                max-value: 1;
                orientation: "vertical";
                size: "small";
                height-override: 200px;
                width: 40px;
                value-changed(v) => {
                    root.track-level = v;
                    root.track-level-changed(v);
                }
            }

            VerticalLayout {
                width: 32px;
                height: 200px;
                spacing: 6px;
                HorizontalLayout {
                    spacing: 4px;
                    RDSVertVUMeter { level: root.track-meter-left; fill-color: #34d399; height: 200px; }
                    RDSVertVUMeter { level: root.track-meter-right; fill-color: #60a5fa; height: 200px; }
                }
            }

            RDSWaveformViz {
                width: parent.width - 420px;
                height: 200px;
                waveform: root.waveform;
                waveform_time_labels: root.waveform_time_labels;
                playhead-index: root.playhead-index;
            }

            Rectangle {
                width: 300px;
                height: 200px;
                background: #121216;
                border-radius: 6px;
                border-color: #2a2a35;
                border-width: 1px;

                GridLayout {
                    padding: 12px;
                    spacing: 8px;
                    Row {
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Speed"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.tape-speed;
                                min-value: -4;
                                max-value: 4;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.05;
                                scroll-sensitivity: 0.05;
                                value-changed(v) => {
                                    root.tape-speed = v;
                                    root.tape-speed-changed(v);
                                }
                            }
                        }
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Rotate"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.tape-rotate;
                                min-value: 0;
                                max-value: 1;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.01;
                                scroll-sensitivity: 0.01;
                                value-changed(v) => {
                                    root.tape-rotate = v;
                                    root.tape-rotate-changed(v);
                                }
                            }
                        }
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "T.Start"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.trigger-start;
                                min-value: 0;
                                max-value: 1;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.01;
                                scroll-sensitivity: 0.01;
                                value-changed(v) => {
                                    root.trigger-start = v;
                                    root.trigger-start-changed(v);
                                }
                            }
                        }
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "L.Start"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.loop-start;
                                min-value: 0;
                                max-value: 1;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.01;
                                scroll-sensitivity: 0.01;
                                value-changed(v) => {
                                    root.loop-start = v;
                                    root.loop-start-changed(v);
                                }
                            }
                        }
                    }
                    Row {
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Length"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.loop-length;
                                min-value: 0.01;
                                max-value: 1;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.01;
                                scroll-sensitivity: 0.01;
                                value-changed(v) => {
                                    root.loop-length = v;
                                    root.loop-length-changed(v);
                                }
                            }
                        }
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Glide"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.tape-glide;
                                min-value: 0;
                                max-value: 1;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.01;
                                scroll-sensitivity: 0.01;
                                value-changed(v) => {
                                    root.tape-glide = v;
                                    root.tape-glide-changed(v);
                                }
                            }
                        }
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "SOS"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.tape-sos;
                                min-value: 0;
                                max-value: 1;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.01;
                                scroll-sensitivity: 0.01;
                                value-changed(v) => {
                                    root.tape-sos = v;
                                    root.tape-sos-changed(v);
                                }
                            }
                        }
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "XFade"; color: #b9b9bf; font-size: 10px; horizontal-alignment: center; }
                            RDSKnob {
                                renderer: "lo-fi";
                                value: root.loop-xfade;
                                min-value: 0;
                                max-value: 0.5;
                                size: 44px;
                                indicator-position: 14px;
                                sensitivity: 0.005;
                                scroll-sensitivity: 0.005;
                                value-changed(v) => {
                                    root.loop-xfade = v;
                                    root.loop-xfade-changed(v);
                                }
                            }
                        }
                    }
                    Row {
                        HorizontalLayout {
                            colspan: 4;
                            spacing: 12px;
                            alignment: space-between;
                            VerticalLayout {
                                spacing: 2px;
                                width: 130px;
                                Text { text: "Rate Mode"; color: #b9b9bf; font-size: 10px; }
                                ComboBox {
                                    height: 24px;
                                    model: root.tape-rate-modes;
                                    current-index: root.tape-rate-mode;
                                    selected => {
                                        root.tape-rate-mode = self.current-index;
                                        root.tape-rate-mode-selected(self.current-index);
                                    }
                                }
                            }
                            VerticalLayout {
                                spacing: 2px;
                                width: 130px;
                                Text { text: "Loop Mode"; color: #b9b9bf; font-size: 10px; }
                                ComboBox {
                                    height: 24px;
                                    model: root.loop-modes;
                                    current-index: root.loop-mode;
                                    selected => {
                                        root.loop-mode = self.current-index;
                                        root.loop-mode-selected(self.current-index);
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        VerticalLayout {
            spacing: 12px;

            HorizontalLayout {
                spacing: 16px;
                width: parent.width;

                VerticalLayout {
                    spacing: 12px;
                    HorizontalLayout {
                        spacing: 8px;
                        Button { text: root.track-muted ? "Unmute" : "Mute"; clicked => root.toggle-track-mute(); }
                        Button { text: root.loop-enabled ? "Loop On" : "Loop Off"; clicked => root.toggle-loop-enabled(); }
                        Button { text: root.tape-reverse ? "Reverse On" : "Reverse Off"; clicked => root.toggle-tape-reverse(); }
                        Button { text: root.tape-freeze ? "Freeze On" : "Freeze Off"; clicked => root.toggle-tape-freeze(); }
                        Button { text: root.tape-keylock ? "Keylock On" : "Keylock Off"; clicked => root.toggle-tape-keylock(); }
                        Button { text: root.tape-monitor ? "Monitor On" : "Monitor Off"; clicked => root.toggle-tape-monitor(); }
                        Button { text: root.tape-overdub ? "Overdub On" : "Overdub Off"; clicked => root.toggle-tape-overdub(); }
                    }
                }
            }

            HorizontalLayout {
                spacing: 16px;
                width: parent.width;

                VerticalLayout {
                    spacing: 8px;
                    width: (parent.width - 16px) / 2;
                    Text { text: "Mosaic Controls"; color: #e4e4ea; font-size: 14px; }
                    HorizontalLayout {
                        spacing: 8px;
                        Button {
                            text: root.mosaic-enabled ? "Mosaic ON" : "Mosaic BYPASS";
                            clicked => root.toggle-mosaic-enabled();
                        }
                    }

                    VerticalLayout {
                        spacing: 0px;

                        HorizontalLayout {
                            spacing: 12px;
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Pitch"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-pitch;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-pitch = v; root.mosaic-pitch-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Rate"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-rate;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-rate = v; root.mosaic-rate-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Size"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-size;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-size = v; root.mosaic-size-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Contour"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-contour;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-contour = v; root.mosaic-contour-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Warp"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-warp;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-warp = v; root.mosaic-warp-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Spray"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-spray;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-spray = v; root.mosaic-spray-changed(v); }
                                }
                            }
                        }

                        HorizontalLayout {
                            spacing: 12px;
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Pattern"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-pattern;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-pattern = v; root.mosaic-pattern-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Wet"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-wet;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-wet = v; root.mosaic-wet-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Detune"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-detune;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-detune = v; root.mosaic-detune-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Spatial"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-spatial;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-spatial = v; root.mosaic-spatial-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Rand Rate"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-rand-rate;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-rand-rate = v; root.mosaic-rand-rate-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Rand Size"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-rand-size;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-rand-size = v; root.mosaic-rand-size-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "SOS"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.mosaic-sos;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.mosaic-sos = v; root.mosaic-sos-changed(v); }
                                }
                            }
                        }
                    }
                }

                VerticalLayout {
                    spacing: 8px;
                    width: (parent.width - 16px) / 2;
                    Text { text: "Ring Controls"; color: #e4e4ea; font-size: 14px; }
                    HorizontalLayout {
                        spacing: 8px;
                        Button {
                            text: root.ring-enabled ? "Ring ON" : "Ring BYPASS";
                            clicked => root.toggle-ring-enabled();
                        }
                    }

                    VerticalLayout {
                        spacing: 0px;

                        HorizontalLayout {
                            spacing: 12px;
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Cutoff"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-cutoff;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-cutoff = v; root.ring-cutoff-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Res"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-resonance;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-resonance = v; root.ring-resonance-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Decay"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-decay;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-decay = v; root.ring-decay-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Pitch"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-pitch;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-pitch = v; root.ring-pitch-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 100px;
                                Text { text: "Decay Mode"; color: #b9b9bf; font-size: 11px; }
                                ComboBox {
                                    model: root.ring-decay-modes;
                                    current-index: root.ring-decay-mode;
                                    selected => {
                                        root.ring-decay-mode = self.current-index;
                                        root.ring-decay-mode-selected(self.current-index);
                                    }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Slope"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-slope;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-slope = v; root.ring-slope-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Tone"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-tone;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-tone = v; root.ring-tone-changed(v); }
                                }
                            }
                        }

                        HorizontalLayout {
                            spacing: 12px;
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Tilt"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-tilt;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-tilt = v; root.ring-tilt-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Wet"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-wet;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-wet = v; root.ring-wet-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Detune"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-detune;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-detune = v; root.ring-detune-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Waves"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-waves;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-waves = v; root.ring-waves-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "W-Rate"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-waves-rate;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-waves-rate = v; root.ring-waves-rate-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "Noise"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-noise;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-noise = v; root.ring-noise-changed(v); }
                                }
                            }
                            VerticalLayout {
                                spacing: 4px;
                                width: 60px;
                                Text { text: "N-Rate"; color: #b9b9bf; font-size: 11px; horizontal-alignment: center; }
                                RDSKnob {
                                    renderer: "lo-fi";
                                    value: root.ring-noise-rate;
                                    min-value: 0; max-value: 1;
                                    size: 48px; indicator-position: 15px;
                                    sensitivity: 0.01; scroll-sensitivity: 0.01;
                                    value-changed(v) => { root.ring-noise-rate = v; root.ring-noise-rate-changed(v); }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
